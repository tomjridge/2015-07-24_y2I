# processing file 'adhoc_open_directory-int.trace' ...
        @type trace

        ##############################################
        # O_DIRECTORY
        ##############################################

     7: mkdir "d1" 0o755
        Tau
        RV_none

        # open directory for searching
    10: open "d1" [O_RDONLY]
        Tau
        RV_num(3)
    11: read (FD 3) 100
        Tau
        EISDIR
    12: close (FD 3)
        Tau
        RV_none

        # using O_DIRECTORY with dirs is fine
        # but we can't do anything afterwards :-)
    16: open "d1" [O_RDONLY;O_DIRECTORY]
        Tau
        RV_num(3)
    17: read (FD 3) 100
        Tau
        EISDIR
    18: close (FD 3)
        Tau
        RV_none

        # using O_DIRECTORY with files fails
    21: open_close "f1.txt" [O_RDONLY;O_CREAT] 0o600
        Tau
        RV_none
    22: open "f1.txt" [O_RDONLY;O_DIRECTORY]
        Tau
        RV_num(3)
    23: read (FD 3) 100
        Tau
        RV_bytes("")
    24: close (FD 3)
        Tau
        RV_none

        # using O_DIRECTORY on non-existing files
    27: open "no-such-file.txt" [O_RDONLY;O_DIRECTORY]
        Tau
        ENOENT
    28: read (FD 3) 100
        Tau
        EBADF
    29: close (FD 3)
        Tau
        EBADF

        # using O_DIRECTORY on non-existing dir
    32: open "/no-such-dir/" [O_RDONLY;O_DIRECTORY]
        Tau
        ENOENT
    33: read (FD 3) 100
        Tau
        EBADF
    34: close (FD 3)
        Tau
        EBADF

        # we can't create directories
    37: open "/no-such-dir/" [O_RDONLY;O_DIRECTORY;O_CREAT] 0o700
        Tau
        EISDIR
    38: read (FD 3) 100
        Tau
        EBADF
    39: close (FD 3)
        Tau
        EBADF

    41: open "/no-such-dir/" [O_RDONLY;O_CREAT] 0o700
        Tau
        EISDIR
    42: read (FD 3) 100
        Tau
        EBADF
    43: close (FD 3)
        Tau
        EBADF


